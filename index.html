<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ankauf Beleg</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container-fluid min-vh-100 d-flex align-items-center justify-content-center py-4">
        <div class="row w-100 justify-content-center">
            <div class="col-12 col-lg-10 col-xl-8">
                <div class="card modern-card">
                    <div class="card-header bg-primary text-white">
                        <h2 class="card-title mb-0 text-center">Ankauf Beleg</h2>
                    </div>
                    <div class="card-body p-4">
                        <!-- Form Section -->
                        <form class="mb-5">
                            <div class="row g-3">
                                <div class="col-12 col-md-6">
                                    <label for="name" class="form-label fw-semibold">Name</label>
                                    <input type="text" class="form-control form-control-lg required" id="name" placeholder="Name">
                                </div>
                                <div class="col-12 col-md-6">
                                    <label for="date" class="form-label fw-semibold">Datum</label>
                                    <input type="text" class="form-control form-control-lg datepicker" id="date" readonly>
                                </div>
                                <div class="col-12">
                                    <label for="address" class="form-label fw-semibold">Adresse</label>
                                    <input type="text" class="form-control form-control-lg required" id="address" placeholder="Adresse">
                                </div>
                                <div class="col-12 col-md-6">
                                    <label for="payment" class="form-label fw-semibold">So bezahlen Sie</label>
                                    <select class="form-select form-select-lg required" id="payment">
                                        <option value="" selected disabled>Zahlungsart ausw√§hlen</option>
                                        <option value="paypal">PayPal</option>
                                        <option value="bank">Bank</option>
                                        <option value="cash">Cash</option>
                                    </select>
                                </div>
                            </div>
                        </form>

                        <!-- Table Section -->
                        <div class="table-responsive">
                            <table class="table table-hover table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th scope="col">Produktname</th>
                                        <th scope="col">Preis</th>
                                        <th scope="col">Artikelcode</th>
                                        <th scope="col" class="text-center">Aktion</th>
                                    </tr>
                                </thead>
                                <tbody class="products">
                                </tbody>
                            </table>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary">
                                Ankauf Beleg erstellen
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Icons -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Bootstrap 5 JS (optional, for enhanced functionality) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script>    
        $(document).ready(function() {
            var d = new Date();
            var today = addZero(d.getDate())+"/"+addZero(d.getMonth()+1)+"/"+d.getFullYear();
            $('#date').val(today);
            $('.datepicker').datepicker({
                format: 'dd/mm/yyyy',
                autoclose: true,
                todayHighlight: true
            });

            addRow();
        });

        function addZero(i) {
            if (i < 10) {
                i = "0" + i;
            }
            return i;
        }

        function addRow()
        {
            $('.bi-plus-circle').addClass('bi-trash').removeClass('bi-plus-circle');
            $('.add-product').addClass('remove-product btn-danger').removeClass('add-product btn-success');
            $('.products').append(`
                <tr>
                    <td>
                        <div>
                            <input type="text" class="form-control required" placeholder="Produktname" name="product_name">
                        </div>
                    </td>
                    <td>
                        <div>
                            <input type="text" class="form-control number required" placeholder="Preis" name="price">
                        </div>
                    </td>
                    <td>
                        <div>
                            <input type="text" class="form-control required" placeholder="Artikelcode" name="item_code">
                        </div>
                    </td>
                    <td class="text-center">
                        <button type="button" class="btn btn-success btn-sm me-2 add-product">
                            <i class="bi bi-plus-circle"></i>
                        </button>
                    </td>
                </tr>
            `);
        }

        function validate() {
            var valid = true;
            $('input, select').removeClass('danger');
            $(".alert-danger").remove();
            $(".required:visible").each(function () {
                if ($(this).val() == "" || $(this).val() == null || ($(this).attr('type') == "checkbox" && !$(this).is(":checked"))) {
                    $(this).closest("div").append('<div class="alert-danger text-danger ps-1">Dieses Feld ist erforderlich</div>');
                    $(this).addClass('danger')
                    valid = false;
                }
            });

            if (!valid) {
                $("html, body").animate(
                    {
                        scrollTop: $(".alert-danger:first").offset().top - 80,
                    },
                    100
                );
            }
            return valid;
        }

        $(document).on('click', '.add-product', function() {
            addRow();
        });
        $(document).on('click', '.remove-product', function() {
            $(this).closest('tr').remove();
        });

        $(document).on('click', '.btn-primary', function() {
            if(!validate()) {
                return;
            }
        });
    </script>
</body>
</html>
